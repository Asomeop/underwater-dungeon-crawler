<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Depths of the Abyss - Underwater Dungeon Crawler</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @keyframes float {
            0%, 100% { transform: translateY(0px); opacity: 0.3; }
            50% { transform: translateY(-30px); opacity: 0.6; }
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // Lucide React Icons (simplified inline versions)
        const Sword = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <polyline points="14.5 17.5 3 6 3 3 6 3 17.5 14.5"></polyline>
                <line x1="13" y1="19" x2="19" y2="13"></line>
                <line x1="16" y1="16" x2="20" y2="20"></line>
                <line x1="19" y1="21" x2="21" y2="19"></line>
            </svg>
        );

        const Shield = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path>
            </svg>
        );

        const Heart = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path>
            </svg>
        );

        const Waves = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <path d="M2 6c.6.5 1.2 1 2.5 1C7 7 7 5 9.5 5c2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1"></path>
                <path d="M2 12c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1"></path>
                <path d="M2 18c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1"></path>
            </svg>
        );

        const UnderwaterDungeonCrawler = () => {
            const [player, setPlayer] = useState({
                hp: 100,
                maxHp: 100,
                attack: 15,
                defense: 0,
                isDefending: false
            });

            const [enemy, setEnemy] = useState(null);
            const [floor, setFloor] = useState(1);
            const [gameLog, setGameLog] = useState(['You descend into the sunken depths...']);
            const [isPlayerTurn, setIsPlayerTurn] = useState(true);
            const [gameOver, setGameOver] = useState(false);
            const [victory, setVictory] = useState(false);

            const enemies = [
                { name: 'Jellyfish', hp: 30, maxHp: 30, attack: 8, emoji: 'ü™º' },
                { name: 'Anglerfish', hp: 45, maxHp: 45, attack: 12, emoji: 'üêü' },
                { name: 'Electric Eel', hp: 40, maxHp: 40, attack: 10, emoji: 'üêç' },
                { name: 'Giant Crab', hp: 55, maxHp: 55, attack: 14, emoji: 'ü¶Ä' },
                { name: 'Octopus', hp: 50, maxHp: 50, attack: 13, emoji: 'üêô' },
                { name: 'Shark', hp: 70, maxHp: 70, attack: 18, emoji: 'ü¶à' },
            ];

            const addLog = (message) => {
                setGameLog(prev => [...prev.slice(-4), message]);
            };

            const spawnEnemy = () => {
                const enemyIndex = Math.min(Math.floor(floor / 2), enemies.length - 1);
                const possibleEnemies = enemies.slice(0, enemyIndex + 1);
                const randomEnemy = possibleEnemies[Math.floor(Math.random() * possibleEnemies.length)];
                const newEnemy = { ...randomEnemy };
                
                // Scale enemy stats based on floor
                const scaling = 1 + (floor - 1) * 0.1;
                newEnemy.hp = Math.floor(newEnemy.hp * scaling);
                newEnemy.maxHp = Math.floor(newEnemy.maxHp * scaling);
                newEnemy.attack = Math.floor(newEnemy.attack * scaling);
                
                setEnemy(newEnemy);
                addLog(`A ${newEnemy.name} emerges from the darkness! ${newEnemy.emoji}`);
            };

            useEffect(() => {
                if (!enemy && !gameOver) {
                    spawnEnemy();
                }
            }, [enemy, gameOver]);

            const playerAttack = () => {
                if (!isPlayerTurn || !enemy || gameOver) return;

                const damage = player.attack + Math.floor(Math.random() * 6);
                const newEnemyHp = Math.max(0, enemy.hp - damage);
                
                setEnemy({ ...enemy, hp: newEnemyHp });
                addLog(`You strike for ${damage} damage!`);
                
                if (newEnemyHp <= 0) {
                    addLog(`The ${enemy.name} is defeated!`);
                    setTimeout(() => {
                        setFloor(f => f + 1);
                        setEnemy(null);
                        const heal = Math.floor(Math.random() * 15) + 10;
                        setPlayer(p => ({ ...p, hp: Math.min(p.maxHp, p.hp + heal), isDefending: false }));
                        addLog(`You descend deeper... Floor ${floor + 1}. Recovered ${heal} HP.`);
                    }, 1000);
                } else {
                    setIsPlayerTurn(false);
                    setPlayer(p => ({ ...p, isDefending: false }));
                }
            };

            const playerDefend = () => {
                if (!isPlayerTurn || !enemy || gameOver) return;

                setPlayer({ ...player, defense: 8, isDefending: true });
                addLog('You brace for impact!');
                setIsPlayerTurn(false);
            };

            useEffect(() => {
                if (!isPlayerTurn && enemy && enemy.hp > 0 && !gameOver) {
                    const timer = setTimeout(() => {
                        const rawDamage = enemy.attack + Math.floor(Math.random() * 5);
                        const damage = Math.max(1, rawDamage - player.defense);
                        const newPlayerHp = Math.max(0, player.hp - damage);
                        
                        setPlayer(p => ({ ...p, hp: newPlayerHp, defense: 0, isDefending: false }));
                        
                        if (player.defense > 0) {
                            addLog(`${enemy.name} attacks for ${damage} damage! (${player.defense} blocked)`);
                        } else {
                            addLog(`${enemy.name} attacks for ${damage} damage!`);
                        }
                        
                        if (newPlayerHp <= 0) {
                            addLog('You have been defeated...');
                            setGameOver(true);
                        } else {
                            setIsPlayerTurn(true);
                        }
                    }, 800);

                    return () => clearTimeout(timer);
                }
            }, [isPlayerTurn, enemy, gameOver, player.defense]);

            const resetGame = () => {
                setPlayer({
                    hp: 100,
                    maxHp: 100,
                    attack: 15,
                    defense: 0,
                    isDefending: false
                });
                setEnemy(null);
                setFloor(1);
                setGameLog(['You descend into the sunken depths...']);
                setIsPlayerTurn(true);
                setGameOver(false);
                setVictory(false);
            };

            const getHpColor = (current, max) => {
                const percent = (current / max) * 100;
                if (percent > 60) return 'bg-teal-400';
                if (percent > 30) return 'bg-yellow-400';
                return 'bg-red-400';
            };

            return (
                <div className="min-h-screen bg-gradient-to-b from-blue-900 via-blue-800 to-cyan-900 flex items-center justify-center p-4">
                    <div className="w-full max-w-2xl">
                        {/* Title */}
                        <div className="text-center mb-6">
                            <h1 className="text-4xl font-bold text-cyan-200 mb-2 flex items-center justify-center gap-2">
                                <Waves className="text-teal-300" />
                                Depths of the Abyss
                                <Waves className="text-teal-300" />
                            </h1>
                            <p className="text-teal-300 text-sm">Floor {floor}</p>
                        </div>

                        {/* Game Area */}
                        <div className="bg-gradient-to-b from-cyan-950/40 to-blue-950/60 rounded-lg p-6 backdrop-blur-sm border-2 border-cyan-700/50 shadow-2xl">
                            {/* Battle Scene */}
                            <div className="mb-6 min-h-48 flex items-center justify-between px-8">
                                {/* Player */}
                                <div className="text-center">
                                    <div className="text-6xl mb-2">ü§ø</div>
                                    <div className="text-cyan-100 font-semibold mb-1">Diver</div>
                                    <div className="w-32">
                                        <div className="flex items-center gap-1 mb-1">
                                            <Heart size={14} className="text-red-400" />
                                            <span className="text-xs text-cyan-200">{player.hp}/{player.maxHp}</span>
                                        </div>
                                        <div className="bg-gray-700 rounded-full h-3 overflow-hidden">
                                            <div 
                                                className={`h-full ${getHpColor(player.hp, player.maxHp)} transition-all duration-300`}
                                                style={{ width: `${(player.hp / player.maxHp) * 100}%` }}
                                            />
                                        </div>
                                    </div>
                                    {player.isDefending && (
                                        <div className="text-xs text-teal-300 mt-1 flex items-center justify-center gap-1">
                                            <Shield size={12} />
                                            Defending
                                        </div>
                                    )}
                                </div>

                                {/* VS */}
                                {enemy && (
                                    <div className="text-cyan-400 text-2xl font-bold opacity-50">‚öîÔ∏è</div>
                                )}

                                {/* Enemy */}
                                {enemy && (
                                    <div className="text-center">
                                        <div className="text-6xl mb-2">{enemy.emoji}</div>
                                        <div className="text-red-300 font-semibold mb-1">{enemy.name}</div>
                                        <div className="w-32">
                                            <div className="flex items-center gap-1 mb-1">
                                                <Heart size={14} className="text-red-400" />
                                                <span className="text-xs text-red-200">{enemy.hp}/{enemy.maxHp}</span>
                                            </div>
                                            <div className="bg-gray-700 rounded-full h-3 overflow-hidden">
                                                <div 
                                                    className="h-full bg-red-500 transition-all duration-300"
                                                    style={{ width: `${(enemy.hp / enemy.maxHp) * 100}%` }}
                                                />
                                            </div>
                                        </div>
                                    </div>
                                )}
                            </div>

                            {/* Game Log */}
                            <div className="bg-blue-950/60 rounded p-3 mb-4 min-h-24 border border-cyan-800/50">
                                {gameLog.map((log, i) => (
                                    <div key={i} className="text-cyan-100 text-sm mb-1 opacity-90">
                                        {log}
                                    </div>
                                ))}
                            </div>

                            {/* Action Buttons */}
                            {!gameOver ? (
                                <div className="flex gap-3 justify-center">
                                    <button
                                        onClick={playerAttack}
                                        disabled={!isPlayerTurn || !enemy}
                                        className="flex items-center gap-2 px-6 py-3 bg-teal-600 hover:bg-teal-500 disabled:bg-gray-600 disabled:opacity-50 text-white rounded font-semibold transition-all shadow-lg disabled:cursor-not-allowed"
                                    >
                                        <Sword size={20} />
                                        Attack
                                    </button>
                                    <button
                                        onClick={playerDefend}
                                        disabled={!isPlayerTurn || !enemy}
                                        className="flex items-center gap-2 px-6 py-3 bg-cyan-700 hover:bg-cyan-600 disabled:bg-gray-600 disabled:opacity-50 text-white rounded font-semibold transition-all shadow-lg disabled:cursor-not-allowed"
                                    >
                                        <Shield size={20} />
                                        Defend
                                    </button>
                                </div>
                            ) : (
                                <div className="text-center">
                                    <div className="text-2xl font-bold text-red-300 mb-4">
                                        {victory ? 'Victory!' : 'Defeated'}
                                    </div>
                                    <button
                                        onClick={resetGame}
                                        className="px-8 py-3 bg-teal-600 hover:bg-teal-500 text-white rounded font-semibold transition-all shadow-lg"
                                    >
                                        Restart Journey
                                    </button>
                                </div>
                            )}

                            {/* Stats */}
                            <div className="mt-4 text-center text-xs text-cyan-300 opacity-75">
                                Attack: {player.attack} | {isPlayerTurn ? 'Your Turn' : 'Enemy Turn'}
                            </div>
                        </div>

                        {/* Atmospheric particles */}
                        <div className="fixed inset-0 pointer-events-none overflow-hidden">
                            {[...Array(20)].map((_, i) => (
                                <div
                                    key={i}
                                    className="absolute rounded-full bg-cyan-300/20"
                                    style={{
                                        width: Math.random() * 6 + 2 + 'px',
                                        height: Math.random() * 6 + 2 + 'px',
                                        left: Math.random() * 100 + '%',
                                        top: Math.random() * 100 + '%',
                                        animation: `float ${Math.random() * 10 + 10}s linear infinite`,
                                        animationDelay: Math.random() * 5 + 's'
                                    }}
                                />
                            ))}
                        </div>
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<UnderwaterDungeonCrawler />);
    </script>
</body>
</html>
